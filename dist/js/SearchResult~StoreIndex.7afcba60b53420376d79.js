(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"8obM":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.search=void 0;var r,i=a("mtWM"),s=(r=i)&&r.__esModule?r:{default:r};t.search=function(e){return s.default.get("/src/json/searchData.json",e)}},DOM9:function(e,t,a){"use strict";(function(e){var r,i=h(a("mvHQ")),s=h(a("Zx67")),n=h(a("kiBT")),o=h(a("OvRC")),l=h(a("C4MV")),c=h(a("Zzip")),u=h(a("pFYg")),d=h(a("5QVw")),p=h(a("woOf"));function h(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var m=p.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},f="function"==typeof d.default&&"symbol"===(0,u.default)(c.default)?function(e){return void 0===e?"undefined":(0,u.default)(e)}:function(e){return e&&"function"==typeof d.default&&e.constructor===d.default&&e!==d.default.prototype?"symbol":void 0===e?"undefined":(0,u.default)(e)},y=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,l.default)(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();t.searchResultState=te,t.searchResultDispatch=ae;var v=a("U7vG"),g=H(v),k=H(a("O27J")),S=a("4n+p"),_=a("Zfgq"),b=T(a("P9l9")),E=(T(a("8obM")),a("d2xe")),w=a("f2Hk"),N=a("zpSi"),D=a("0p2n"),L=H(a("BYKG"));a("GKj9");var C=H(a("6YRh")),I=a("f2t5"),F=a("2uFj");function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function H(e){return e&&e.__esModule?e:{default:e}}function P(e,t,a){return t in e?(0,l.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,u.default)(t))&&"function"!=typeof t?e:t}function B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,u.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}var M=(0,w.concatPageAndType)("searchResult3"),A=(0,w.concatPageAndType)("searchIndex"),j=(0,w.concatPageAndType)("qygSearch"),Q=b,R={search_keywords:"key",coupon_id:"coupon_id",shop:"shop",brand:"brand",category:"category",properties:"property",order_by:"order",search_type:"type",price_range:"price",service:"service",page:"page",country_id:"country_id",promotion_id:"promotion_id"},q=function(t){function a(e,t){x(this,a);var r=O(this,(a.__proto__||(0,s.default)(a)).call(this,e));return e.storeHomeRequest||(document.title="搜索结果"),r.state={topButtonState:!1},r}return B(a,v.Component),y(a,[{key:"componentWillMount",value:function(){this.props.setFilterUpdate(!1),"item"==this.props.from&&this.props.setFrom("");var e=this.props.location.query,t=e.key,a=e.coupon_id,r=e.brand,i=e.category,s=e.property,n=e.order,o=e.type,l=e.shop,c=e.price,u=e.service,d=e.country_id,p=e.promotion_id,h=this.props,m=h.shop_attr,f=h.storeHomeRequest,y={search_keywords:t=void 0!==t?decodeURIComponent(t):"",coupon_id:void 0!==a?a:"",shop:void 0!==l?l:"",brand:void 0!==r?r:"",category:void 0!==i?Number(i):"",properties:void 0!==s?s:"",order_by:void 0!==n?n:"",search_type:f&&m?m:void 0!==o?o:"",price_range:void 0!==c?c:"",service:void 0!==u?this.formatSearchData(u):"",page:1,country_id:void 0!==d?Number(d):"",promotion_id:void 0!==p?p:""};this.props.dispatch(M("setSearch",{searchData:y}))}},{key:"componentWillReceiveProps",value:function(e){if(this.props.searchData!==e.searchData){var t=(0,p.default)({},e.searchData,{search_keywords:e.correction||e.searchData.search_keywords}),a=e.init,r=this.props.filterUpdate;this.changeUrl(e.searchData),this.props.setData(t,a,r)}}},{key:"componentDidMount",value:function(){var t=this,a=Math.max(this.props.windowHeight,e(window).height());e(window).scroll(function(){var r=e(window).scrollTop();t.state.topButtonState!==r>a&&t.setState({topButtonState:r>a})}),this.props.windowHeight<e(window).height()&&this.props.setWindowHeight(e(window).height())}},{key:"componentDidUpdate",value:function(){C.default.init({offset:e(window).height(),throttle:1e3})}},{key:"componentWillUnmount",value:function(){this.props.setFilterUpdate(!0),e("body").css({overflowY:"",position:"static"}),this.props.setCorrection(""),e(window).unbind("scroll")}},{key:"changeUrl",value:function(e){var t="",a=location.href.split("?")[0];for(var r in e)e.hasOwnProperty(r)&&e[r]&&(t+="&"+R[r]+"="+("service"==r?this.formatSearchData(e[r]):e[r]));history.replaceState({},null,a+"?"+t.substr(1))}},{key:"formatSearchData",value:function(e){var t="",a={};if("object"==(void 0===e?"undefined":f(e))){for(var r in e)e.hasOwnProperty(r)&&(t+=e[r]?r+",":"");return t.substr(0,t.length-1)}if("string"==typeof e){for(var i=e.split(","),s=0;s<i.length;s++)a[i[s]]=1;return a}}},{key:"dropDown",value:function(e){var t=this.props,a=t.searchData,r=t.dispatch,i=t.currentPage,s=t.totalPage,n=t.load,o=t.goodsList,l=t.correction;if(!n||!o||i>=s)return e.lock(),e.noData(),void e.resetload();(a=L.default.fromJS(a).toJS()).search_keywords=l||a.search_keywords,a.page=i+1,Q.search(a).then(function(t){if(0!==t.data.code)return e.lock(),e.noData(),void e.resetload();r(M("concatData",{result:t.data})),r(M("setCurrentPage",{current:i+1})),e.resetload();var a=t.data.data.page;a.current_page>=a.total_page&&(e.lock(),e.noData(),e.resetload())}).catch(function(t){console.error(t),e.resetload()})}},{key:"render",value:function(){var e=this.props,t=e.errorState,a=e.load,r=e.init,i=e.categoriesLevelList,s=e.goodsList,n=e.listStyle,o=e.setFrom,l=e.setGoodHeight,c=e.goodHeight,u=e.correction,d=e.coupon,p=e.searchData,h=e.storeHomeRequest,m=e.setFilterState,f=e.filterState,y=e.promotion;return r?g.default.createElement("div",{id:"searchResult","data-page":"search-page3",style:{minHeight:this.props.windowHeight}},g.default.createElement(J,this.props),!t&&a&&i&&i.length>0&&s&&s.length>0?g.default.createElement(V,{searchData:p,correction:u,coupon:d}):"",t?g.default.createElement(E.NetError,null):a?i&&i.length?s&&s.length?1==n?g.default.createElement(X,{key:"1",goodsList:s,listStyle:n,setFrom:o,setGoodHeight:l,promotion:y,goodHeight:c,scrollArea:window,dropDown:this.dropDown.bind(this),storeHomeRequest:h,setFilterState:m,filterState:f}):g.default.createElement(X,{key:"2",goodsList:s,listStyle:n,setFrom:o,setGoodHeight:l,promotion:y,goodHeight:c,scrollArea:window,dropDown:this.dropDown.bind(this),storeHomeRequest:h,setFilterState:m,filterState:f}):g.default.createElement(E.FilterNone,null):g.default.createElement(E.SearchNone,null):g.default.createElement(E.LoadingRound,null),this.state.topButtonState?g.default.createElement(ee,null):""):g.default.createElement(E.LoadingRound,null)}}]),a}(),J=function(e){function t(){return x(this,t),O(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return B(t,v.Component),y(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,a=e.setSearch,r=e.setSearchService,i=e.setData,s=e.toggleQuickSelect,n=e.searchData,o=e.brandsList,l=e.brandsOrderList,c=e.categoriesList,u=e.categoriesLevelList,d=e.properties,p=e.service,h=e.listStyle,m=e.errorState,f=e.storeHomeRequest,y=e.isQuickSelect,v=e.filterState,k=e.setFilterState,S=n.search_keywords,_=n.search_type,b=!m&&o&&o.length&&u&&u.length;return g.default.createElement("div",{className:"filter-condition "+(f?"store-container":"")+" "+(v?"":"filter-reduce"),ref:"filterCondition"},f?"":g.default.createElement(W,{ref:"searchInput",dispatch:t,keyWord:S,searchData:n,searchType:_,listStyle:h,toggleQuickSelect:s,filterState:v,setFilterState:k}),b?g.default.createElement(U,{setSearch:a,searchData:n,toggleQuickSelect:s}):"",b&&!f?g.default.createElement(G,{setSearch:a,searchData:n,setData:i,toggleQuickSelect:s,brandsList:o,brandsOrderList:l,categoriesList:c,categoriesLevelList:u,properties:d,service:p}):"",b&&!f?g.default.createElement(K,{setSearch:a,setSearchService:r,setData:i,toggleQuickSelect:s,searchData:n,brandsList:o,categoriesList:c,isQuickSelect:y}):"")}}]),t}(),W=function(t){function a(){var t,r,i;x(this,a);for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=i=O(this,(t=a.__proto__||(0,s.default)(a)).call.apply(t,[this].concat(o))),i.searchBarFocus=function(){i.props.toggleQuickSelect(!1),"biz"===i.props.searchType?(i.props.dispatch(j("keyCtrl",{key:i.props.keyWord})),i.props.dispatch(j("paramCtrl",{param:i.props.searchData})),_.browserHistory.replace("/qygSearch")):(i.props.dispatch(A("keyCtrl",{key:i.props.keyWord})),i.props.dispatch(A("paramCtrl",{param:i.props.searchData})),_.browserHistory.replace("/search"))},i.changeType=function(){var t=i;!t.props.storeHomeReques&&e(window).unbind("scroll",t.currentScrollEvent);var a=1==i.props.listStyle?2:1;i.props.dispatch(M("changeListStyle",{style:a})),setTimeout(function(){!t.props.storeHomeReques&&e(window).bind("scroll",t.currentScrollEvent)},0)},O(i,r)}return B(a,v.Component),y(a,[{key:"componentDidMount",value:function(){var t=e(k.default.findDOMNode(this.refs.searchInput)).height(),a=e(".order-filter").height();this.currentTop=0,this.currentScrollEvent=this.scrollControlFilter.bind(this,t,a),!this.props.storeHomeRequest&&e(window).bind("scroll",this.currentScrollEvent)}},{key:"scrollControlFilter",value:function(t,a){var r=e(window).scrollTop();r-t-a>=0?r-this.currentTop>=2?this.props.filterState&&this.props.setFilterState(!1):r-this.currentTop<=-2&&(this.props.filterState||this.props.setFilterState(!0)):this.props.filterState||this.props.setFilterState(!0),this.currentTop=r}},{key:"render",value:function(){return g.default.createElement(E.SearchBarA,{value:this.props.keyWord,param:this.props.searchData,onChange:function(e){},onFocus:this.searchBarFocus,changeType:this.changeType,listStyle:this.props.listStyle})}}]),a}(),U=function(e){function t(e){x(this,t);var a=O(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.orderFilter=[{name:"综合",type:""},{name:"销量",type:"sell_count"},{name:"新品",type:"shelved"},{name:"价格",type:"price",orderControl:!0}],a.orderIcon={normal:"arrow-tb-icon",asc:"arrow-tr-bg-icon",desc:"arrow-tg-br-icon"},a}return B(t,v.Component),y(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.searchData!==e.searchData}},{key:"filterClick",value:function(e,t){var a=this.props.searchData.order_by,r=a.split(":")[0],i=a.split(":")[1],s=!1;if(t)s=e!=r||"desc"==i;else if(e==r)return;this.props.toggleQuickSelect(!1);var n=e&&e+":"+(s?"asc":"desc");this.props.setSearch({order_by:n})}},{key:"isActive",value:function(e){var t=this.props.searchData.order_by;return t?t.split(":")[0]==e:!e}},{key:"getOrderFilter",value:function(){var e=this;return this.orderFilter.map(function(t,a){var r=e.isActive(t.type);return g.default.createElement("li",{key:a,onClick:e.filterClick.bind(e,t.type,t.orderControl),className:"order-filter-item "+(r?"active":"")},g.default.createElement("span",null,t.name),t.orderControl?g.default.createElement("i",{className:e.orderIcon[r?e.props.searchData.order_by.split(":")[1]:"normal"]}):"")})}},{key:"render",value:function(){return g.default.createElement("ul",{className:"order-filter"},this.getOrderFilter())}}]),t}(),G=function(t){function a(e){x(this,a);var t=O(this,(a.__proto__||(0,s.default)(a)).call(this,e));return t.state={select:!1},t}return B(a,v.Component),y(a,[{key:"toggleAdvancedFilterSelect",value:function(){var t=this.state.select;this.setState({select:!t},function(){e("body").css({overflowY:this.state.select?"hidden":"",position:this.state.select?"fixed":"static"})}),this.props.toggleQuickSelect(!1)}},{key:"render",value:function(){var e=this.state.select;return g.default.createElement("div",{className:"advanced-filter",onClick:this.toggleAdvancedFilterSelect.bind(this)},g.default.createElement("span",{className:"advanced-filter-span"},"筛选"),g.default.createElement("i",{className:"filter-grey-icon"}),e?g.default.createElement(Y,m({},this.props,{toggleAdvancedFilterSelect:this.toggleAdvancedFilterSelect.bind(this)})):"",e?g.default.createElement(E.Shady,{options:{zIndex:1}}):"")}}]),a}(),Y=function(e){function t(e){x(this,t);var a=O(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.state={allItem:!1,priceStart:"",priceEnd:""},a.service={promotion:"促销",is_self:"自营",store_only:"仅看有货",tax_free:"包税",support_ecard:"支持活动e卡"},a}return B(t,v.Component),y(t,[{key:"componentWillMount",value:function(){for(var e=this.props.searchData,t=this.getData(),a={},r=0;r<t.length;r++){var i=t[r].key;a[i+"Id"]={},a[i+"Name"]={}}for(var s=0;s<t.length;s++)if(e[t[s].type]){var n=t[s].key,o=t[s].list,l="";if("service"==t[s].type){var c=e[t[s].type],u=[];for(var d in c)c.hasOwnProperty(d)&&c[d]&&u.push(d);l=u}else l=e[t[s].type].toString().split(",");for(var p=0;p<o.length;p++)for(var h=o[p][t[s].id],m=o[p].name||o[p].text,f=0;f<l.length;f++)l[f]==h&&(a[n+"Id"][h]=!0,a[n+"Name"][h]=m)}if(e.price_range){var y=e.price_range.toString().split(":");y[0]&&y[1]?(a.priceStart=Math.min(y[0],y[1])||"",a.priceEnd=Math.max(y[0],y[1])||""):(a.priceStart=y[0]||"",a.priceEnd=y[1]||"")}this.setState(a)}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"getService",value:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push({service_id:a,name:this.service[a]});return t}},{key:"getData",value:function(){var e=[],t=this.props,a=t.service,r=t.brandsList,i=t.brandsOrderList,s=t.categoriesLevelList,n=t.properties;e.push({key:"service",type:"service",id:"service_id",name:"小泰服务",list:this.getService(a),displayStyle:1}),e.push({key:"price",type:"price",id:"price_id",name:"价格区间",displayStyle:0}),e.push({key:"brand",type:"brand",id:"brand_id",name:"品牌",list:r,orderList:i,displayStyle:1,limit:2,maxLimit:5});for(var o=0;o<s.length;o++)e.push({key:"category"+o,type:"category",id:"category_id",name:s[o].name,list:s[o].children,displayStyle:1,limit:1});for(var l=0;l<n.length;l++){n[l].is_country&&1==n[l].is_country?e.push({key:"country",type:"country_id",id:"country_id",name:n[l].name,list:n[l].list,displayStyle:1,limit:1}):e.push({key:"properties"+l,type:"properties",id:"property_value_id",name:n[l].name,list:n[l].list,displayStyle:1,limit:1})}for(var c=0;c<e.length;c++)e[c].hasMore=!!(e[c].limit&&e[c].list.length>3*e[c].limit),e[c].hasAll=!!(e[c].maxLimit&&e[c].list.length>3*e[c].maxLimit-1);return e}},{key:"resetData",value:function(){for(var e=this.getData(),t={},a=0;a<e.length;a++){var r=e[a].key;t[r+"Id"]={},t[r+"Name"]={}}t.priceStart="",t.priceEnd="",this.setState(t)}},{key:"ensureData",value:function(){for(var e=this.props.setSearch,t=L.default.fromJS(this.state).toJS(),a=this.getData(),r={},s=0;s<a.length;s++)if(t[a[s].key+"Id"]){var n=t[a[s].key+"Id"];if("service"==a[s].type&&"{}"!=(0,i.default)(n)){for(var o in n)n.hasOwnProperty(o)&&(n[o]=n[o]?1:0);r.service=n}else if("price"==a[s].type)this.state.priceStart&&this.state.priceEnd?r.price_range=this.state.priceStart+":"+this.state.priceEnd:r.price_range="";else{var l=r[a[s].type]?r[a[s].type].toString().split(","):[];for(var c in n)n.hasOwnProperty(c)&&n[c]&&l.push(c);r[a[s].type]=l.join(",")}}e(r),this.props.toggleAdvancedFilterSelect()}},{key:"sliceListByLimit",value:function(e,t,a){var r="max"==a?3*t-1:3*t;return t&&e.length>r?e.slice(0,r):e}},{key:"toggleItemSelect",value:function(e){var t=e+"Select";this.setState(P({},t,!this.state[t]))}},{key:"toggleItem",value:function(e,t,a){var r,i=L.default.fromJS(this.state[a+"Id"]||{}).toJS(),s=L.default.fromJS(this.state[a+"Name"]||{}).toJS();i[e]=!i[e],s[e]=s[e]?"":t,this.setState((P(r={},a+"Id",i),P(r,a+"Name",s),r))}},{key:"setPrice",value:function(e,t){this.setState(P({},e,t.target.value))}},{key:"getChooseNameText",value:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&e[a]&&t.push(e[a]);return t.join(",")}},{key:"showAllItem",value:function(){this.setState({allItem:!0})}},{key:"hideAllItem",value:function(){this.setState({allItem:!1})}},{key:"setBrand",value:function(e,t){this.setState({brandId:e,brandName:t})}},{key:"getAdvancedItem",value:function(){var e=this;return this.getData().map(function(t,a){var r=t.limit,i=t.maxLimit,s=e.state[t.key+"Id"]||{},n=e.state[t.key+"Name"]||{},o=e.getChooseNameText(n),l=e.state,c=l.priceStart,u=l.priceEnd,d=t.key+"Select",p=e.state[d]?t.maxLimit?e.sliceListByLimit(t.list,i,"max"):t.list:e.sliceListByLimit(t.list,r);return g.default.createElement("div",{key:a,className:"select-item"},g.default.createElement("div",{className:"select-title"},g.default.createElement("div",{className:"title-left"},g.default.createElement("div",null,g.default.createElement("span",null,t.name))),g.default.createElement("div",{className:"title-right"},g.default.createElement("div",{className:"choose-name"},g.default.createElement("span",null,o)),t.hasMore?g.default.createElement("div",{className:"more-item",onClick:e.toggleItemSelect.bind(e,t.key)},g.default.createElement("span",null,"更多"),g.default.createElement("i",{className:e.state[d]?"arrow-mi-up-icon":"arrow-mi-down-icon"})):"")),t.displayStyle?g.default.createElement("ul",{className:"select-content"},p.map(function(a,r){return g.default.createElement("li",{className:"select-content-item",key:r,onClick:e.toggleItem.bind(e,a[t.id],a.name||a.text,t.key)},g.default.createElement("div",{className:s[a[t.id]]?"active":""},a.name||a.text))}),t.hasAll&&e.state[d]?g.default.createElement("li",{className:"all-item-button",onClick:e.showAllItem.bind(e,t.type)},g.default.createElement("span",null,"全部品牌"),g.default.createElement("i",{className:"arrow-right-m-icon"}),g.default.createElement("i",{className:"arrow-right-m-icon"})):""):g.default.createElement("div",{className:"select-content"},g.default.createElement("input",{value:c,onChange:e.setPrice.bind(e,"priceStart"),placeholder:"最低价格"}),g.default.createElement("span",{className:"space-character"},"一"),g.default.createElement("input",{value:u,onChange:e.setPrice.bind(e,"priceEnd"),placeholder:"最高价格"})),t.orderList&&e.state.allItem?g.default.createElement(z,{data:t.orderList,activeBrandId:e.state.brandId,activeBrandName:e.state.brandName,hideAllItem:e.hideAllItem.bind(e),setBrand:e.setBrand.bind(e)}):"")})}},{key:"render",value:function(){return g.default.createElement("div",{className:"advanced-filter-select",onClick:this.stopPropagation.bind(this)},g.default.createElement("div",null,this.getAdvancedItem()),g.default.createElement("div",{className:"control-button"},g.default.createElement("div",{className:"reset-button c-bge4",onClick:this.resetData.bind(this)},"重置"),g.default.createElement("div",{className:"ensure-button c-bgdred",onClick:this.ensureData.bind(this)},"确定")))}}]),t}(),z=function(t){function a(e){x(this,a);var t=O(this,(a.__proto__||(0,s.default)(a)).call(this,e));return t.state={alphabetIdList:{},alphabetNameList:{}},t}return B(a,v.Component),y(a,[{key:"componentWillMount",value:function(){this.setState({alphabetIdList:this.props.activeBrandId,alphabetNameList:this.props.activeBrandName})}},{key:"componentDidMount",value:function(){for(var t=e(".item-item"),a=e(this.refs.container),r=[],i=-1,s=0;s<t.length;s++){var n=t.eq(s);r.push(n.offset().top-n.find(".item-item-title").height())}navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/)||a.scroll(function(){for(var a=e(this).scrollTop(),s=0;s<r.length-1;s++){var n=r[s],o=r[s+1];a>=n&&a<o&&s!=i&&(i=s,t.removeClass("alphabet-float"),t.eq(s).addClass("alphabet-float"))}})}},{key:"toggleItem",value:function(e,t){var a=L.default.fromJS(this.state.alphabetIdList).toJS(),r=L.default.fromJS(this.state.alphabetNameList).toJS();a[e]=!a[e],r[e]=r[e]?"":t,this.setState({alphabetIdList:a,alphabetNameList:r})}},{key:"resetData",value:function(){this.setState({alphabetIdList:{},alphabetNameList:{}})}},{key:"ensureData",value:function(){this.props.setBrand(this.state.alphabetIdList,this.state.alphabetNameList),this.props.hideAllItem()}},{key:"scrollToAlphabet",value:function(t){var a=e(this.refs[t]),r=e(this.refs.container),i=a.offset().top-r.offset().top+r.scrollTop();r.scrollTop(i+1)}},{key:"render",value:function(){var e=this,t=this.props.data,a=[];for(var r in t)t.hasOwnProperty(r)&&a.push(r);return g.default.createElement("div",{className:"all-item"},g.default.createElement("div",{className:"all-item-title"},g.default.createElement("span",{className:"back-button",onClick:this.props.hideAllItem},g.default.createElement("i",{className:"arrow-left-black-icon"})),g.default.createElement("span",{className:"title-text"},"品牌")),g.default.createElement("div",{className:"all-item-content"},g.default.createElement("div",{className:"item-list",ref:"container"},a.map(function(a,r){var i=t[a];return g.default.createElement("div",{className:"item-item",key:r},g.default.createElement("div",{className:"item-item-title",ref:a},a),g.default.createElement("ul",{className:"item-item-content"},i.map(function(t,a){var r=e.state.alphabetIdList[t.brand_id];return g.default.createElement("li",{className:r?"active":"",key:a,onClick:e.toggleItem.bind(e,t.brand_id,t.name)},t.name)})))})),g.default.createElement("ul",{className:"alphabet-list"},a.map(function(t,a){return g.default.createElement("li",{key:a,onClick:e.scrollToAlphabet.bind(e,t)},t)}))),g.default.createElement("div",{className:"control-button"},g.default.createElement("div",{className:"reset-button c-bge4",onClick:this.resetData.bind(this)},"清空品牌"),g.default.createElement("div",{className:"ensure-button c-bgdred",onClick:this.ensureData.bind(this)},"确定")))}}]),a}(),K=function(t){function a(e){x(this,a);var t=O(this,(a.__proto__||(0,s.default)(a)).call(this,e));return t.state={},t.quickFilter=[{name:"自营",type:"is_self",style:"click"},{name:"促销",type:"promotion",style:"click"},{name:"品牌",type:"brand",style:"select"},{name:"分类",type:"category",style:"select"}],t}return B(a,v.Component),y(a,[{key:"stopSelect",value:function(){this.props.toggleQuickSelect(!1)}},{key:"filterClick",value:function(e,t){if("click"==t){var a=this.props.searchData.service||{};a[e]=a[e]?0:1,this.props.toggleQuickSelect(!1),this.props.setSearchService(a)}else if("select"==t){var r=this.props.isQuickSelect;this.state.type==e?this.props.toggleQuickSelect(!r):(this.setState({type:e}),this.props.toggleQuickSelect(!0))}}},{key:"isActive",value:function(e,t){var a=!1;return"click"==t?a=this.props.searchData.service&&this.props.searchData.service[e]:"select"==t&&(a=this.props.searchData[e]),!!a}},{key:"isSelect",value:function(e,t){var a=!1;return"select"==t&&e==this.state.type&&this.props.isQuickSelect&&(a=!0),a}},{key:"showChooseItem",value:function(e){var t=this.props,a=t.searchData,r=t.brandsList,i=t.categoriesList,s=a[e].toString().split(","),n=[];if("brand"==e)for(var o=0;o<r.length;o++){var l=this.getNameById(r[o],s,e);l&&n.push(l)}else{if("category"!=e)return console.log("error"),0;for(var c=0;c<i.length;c++){var u=this.getNameById(i[c],s,e);u&&n.push(u)}}return n.join(",")}},{key:"getNameById",value:function(e,t,a){for(var r=0;r<t.length;r++)if("brand"==a){if(t[r]==e.brand_id)return e.name}else{if("category"!=a)return console.log("error"),"";if(t[r]==e.category_id)return e.name}}},{key:"getQuickFilter",value:function(){var e=this;return this.quickFilter.map(function(t,a){var r=e.isActive(t.type,t.style),i=e.isSelect(t.type,t.style);return g.default.createElement("li",{key:a,className:i?"select":r?"click"==t.style?"active":"select-active":"",onClick:e.filterClick.bind(e,t.type,t.style)},g.default.createElement("div",null,g.default.createElement("span",null,"select"==t.style&&!i&&r?e.showChooseItem(t.type):t.name),"select"!=t.style||!i&&(i||r)?"":g.default.createElement("i",{className:i?"arrow-top-black-icon":"arrow-btm-black-icon"})))})}},{key:"preventScroll",value:function(t){t?e("body").css({overflowY:"hidden",position:"fixed"}):e("body").css({overflowY:"",position:"static"})}},{key:"render",value:function(){var e=this.props.isQuickSelect,t=this.props,a=t.brandsList,r=t.categoriesList,i=t.searchData,s=t.setSearch;return this.preventScroll(e),g.default.createElement("div",{className:"quick-filter"},g.default.createElement("ul",{className:"filter-list"},this.getQuickFilter()),e?g.default.createElement(Z,{setSearch:s,brandsList:a,categoriesList:r,type:this.state.type,searchData:i,stopSelect:this.stopSelect.bind(this)}):"",e?g.default.createElement(E.Shady,{options:{zIndex:-1}}):"")}}]),a}(),Z=function(e){function t(e){x(this,t);var a=O(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.state={list:{}},a}return B(t,v.Component),y(t,[{key:"componentWillMount",value:function(){this.initSelect(this.props.type)}},{key:"componentWillReceiveProps",value:function(e){this.props.type!=e.type&&this.initSelect(e.type)}},{key:"selectFilter",value:function(e){var t=this.state.list;t[e]=!t[e],this.setState({list:t})}},{key:"initSelect",value:function(e){var t={},a=[];for(var r in"brand"==e&&this.props.searchData.brand?a=this.props.searchData.brand.toString().split(","):"category"==e&&this.props.searchData.category&&(a=this.props.searchData.category.toString().split(",")),a)a.hasOwnProperty(r)&&(t[a[r]]=!0);this.setState({list:t})}},{key:"resetSelect",value:function(){this.setState({list:{}})}},{key:"ensureSelect",value:function(){var e=this.state.list,t=this.props,a=t.setSearch,r=t.type,i=[];for(var s in e)e.hasOwnProperty(s)&&e[s]&&i.push(s);a(P({},r,i.join(","))),this.props.stopSelect()}},{key:"getFilterList",value:function(){var e=this.props,t=e.brandsList,a=e.categoriesList,r=e.type,i=this,s="";return"brand"==r?s=t.map(function(e,t){return g.default.createElement("li",{key:t,onClick:i.selectFilter.bind(i,e.brand_id,e.name)},g.default.createElement("div",{className:i.state.list[e.brand_id]?"choose":""},e.name))}):"category"==r&&(s=a.map(function(e,t){return g.default.createElement("li",{key:t,onClick:i.selectFilter.bind(i,e.category_id,e.name)},g.default.createElement("div",{className:i.state.list[e.category_id]?"choose":""},e.name))})),s}},{key:"render",value:function(){return g.default.createElement("div",{className:"quick-filter-select"},g.default.createElement("ul",{className:"select-list"},this.getFilterList()),g.default.createElement("div",{className:"reset-button c-bge4",onClick:this.resetSelect.bind(this)},"重置"),g.default.createElement("div",{className:"ensure-button c-bgdred",onClick:this.ensureSelect.bind(this)},"确定"))}}]),t}(),V=function(e){function t(){return x(this,t),O(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return B(t,v.Component),y(t,[{key:"render",value:function(){var e=this.props,t=e.searchData,a=e.correction,r=e.coupon;return g.default.createElement("div",{className:"prompt"},r?g.default.createElement("p",null,"以下商品可以使用",g.default.createElement("span",{className:"coupon-info"},"满",r.limit_money,"减",r.deduct_money),"的优惠券"):"",a?g.default.createElement("p",null,"没找到“",g.default.createElement("span",{className:"good-name"},t.search_keywords),"”相关商品，已为您推荐“",g.default.createElement("a",{href:"/searchResult?key="+a},g.default.createElement("span",{className:"good-name"},a)),"”相关商品"):"")}}]),t}(),X=(0,N.DropDownLoad)(r=function(t){function a(){var e,t,r;x(this,a);for(var i=arguments.length,n=Array(i),o=0;o<i;o++)n[o]=arguments[o];return t=r=O(this,(e=a.__proto__||(0,s.default)(a)).call.apply(e,[this].concat(n))),r.promotionTags=function(){var e=r.props.promotion;if("FullDiscount"===e.type){var t=e.rules.map(function(e,t){return g.default.createElement("span",{className:"proTips",key:t}," ",g.default.createElement("span",{className:"pro_x"},e.full),"件",g.default.createElement("span",{className:"pro_y"},e.percent),"折,")});return g.default.createElement("p",{className:"promotionTitle"},"以下商品",t)}if("FullMinus"===e.type){var a=e.rules.rule.map(function(e,t){return g.default.createElement("span",{className:"proTips",key:t},"满",g.default.createElement("span",{className:"pro_x"},e.limit_money),"减",g.default.createElement("span",{className:"pro_y"},e.deduct_money,","))});return g.default.createElement("p",{className:"promotionTitle"},"以下商品",a,"上不封顶")}return"OptionBuy"===e.type?g.default.createElement("p",{className:"promotionTitle"},"以下商品",g.default.createElement("span",{className:"pro_x"},e.rules.amount),"元任选",g.default.createElement("span",{className:"pro_y"},e.rules.quantity),"件"):"ExchangeBuy"===e.type?g.default.createElement("p",{className:"promotionTitle"},"以下商品满",g.default.createElement("span",{className:"pro_x"},e.rules.exchange_full),"元加价可换购",g.default.createElement("span",{className:"pro_y"},e.rules.exchange_count),"件热销商品,请前往购物袋换购"):void 0},O(r,t)}return B(a,v.Component),y(a,[{key:"componentDidMount",value:function(){this.setMinListHeight(),this.changeScrollHeightByGoodsStyle()}},{key:"setMinListHeight",value:function(){document.getElementsByClassName("goods-list")[0].style.minHeight=e(window).height()-e(".prompt").height()-174+"px",document.getElementsByClassName("goods-list")[0].minHeight=e(window).height()-e(".prompt").height()-174+"px"}},{key:"changeScrollHeightByGoodsStyle",value:function(){var t=this.props.goodHeight,a=e(".goods-list .good-item").height(),r=e(window).scrollTop(),i=t>a,s=i?2*parseInt(r/t):parseInt(r/t);e(window).scrollTop((i?s:Math.ceil(s/2))*a),this.props.setGoodHeight(a)}},{key:"render",value:function(){var e=this.props,t=e.goodsList,a=e.setFrom,r=e.promotion,i=1==this.props.listStyle?"style1":"style2";return g.default.createElement("div",{className:"goods-list "+i},r&&this.promotionTags(),t.map(function(e,t){return g.default.createElement($,{key:t,data:e,index:t,setFrom:a})}))}}]),a}())||r,$=function(e){function t(e){x(this,t);var a=O(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.tradeTypeObj={Domestic:{name:"国内贸易",style:"hide-tag"},Overseas:{name:"海外直邮",style:"yellow-tag"},Bonded:{name:"跨境保税",style:"blue-tag"},Direct:{name:"海外直邮",style:"yellow-tag"}},a}return B(t,v.Component),y(t,[{key:"showPromotionDetail",value:function(e){return e.map(function(e,t){return g.default.createElement("span",{className:"promotion-tag",key:t},e)})}},{key:"showTopTagsByLevel",value:function(e){var t="";return(t=e?e.is_new_group?"新人团":e.is_hot?"热销":e.is_new?"新品":"":"")?g.default.createElement("span",{className:"new-hot-tag"},t):""}},{key:"render",value:function(){var e=this.props.data,t=e.item_id,a=e.primary_image,r=e.title,i=e.sell_price,s=(e.market_price,e.activity_price),n=e.support_ecard,o=e.item_tag,l=e.top_tags,c=e.trade_type,u=e.promotionDetail,d=e.store,p=e.valid;return g.default.createElement("div",{className:"good-item",onClick:this.props.setFrom.bind(this,"item")},g.default.createElement("a",{href:F.RNDomain+"/item?item_id="+t},g.default.createElement("div",{className:"good-image"},g.default.createElement("img",{className:"primary-image","data-echo":a?a+"_m.jpg":"/src/img/search/no-goods-image.png",src:"/src/img/icon/loading/default-watermark.png"}),d&&p?"":g.default.createElement("img",{className:"no-goods-count-image",src:"/src/img/search/no-goods-count.png"})),g.default.createElement("div",{className:"good-content"},g.default.createElement("div",{className:"good-title"},r),g.default.createElement("div",{className:"good-price"},g.default.createElement("span",{className:"sell-price"},g.default.createElement("span",{className:"money-icon"},"￥"),s||i)," ",n?g.default.createElement("img",{className:"support-ecard",src:"/src/img/common/support-ecard.png"}):""),g.default.createElement("div",{className:"good-bottom-tag"},c?g.default.createElement("span",{className:"trade-tag "+this.tradeTypeObj[c].style},this.tradeTypeObj[c].name):"",u&&u.length?this.showPromotionDetail(u):"")),g.default.createElement("div",{className:"good-top-tag"},o.square_tag_image?g.default.createElement("img",{src:o.square_tag_image}):this.showTopTagsByLevel(l))))}}]),t}(),ee=function(e){function t(){return x(this,t),O(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return B(t,v.Component),y(t,[{key:"jumpToTop",value:function(){(0,I.scrollTo)(0,50)}},{key:"render",value:function(){return g.default.createElement("div",{className:"jump-top-button",onClick:this.jumpToTop.bind(this)},g.default.createElement("i",{className:"jump-top-icon"}))}}]),t}();function te(e){return m({},e.searchResult3)}function ae(e){return{dispatch:e,setFrom:function(t){e(M("setFrom",{from:t}))},setFilterState:function(t){e(M("setFilterState",{filterState:t}))},setFilterUpdate:function(t){e(M("setFilterUpdate",{filterUpdate:t}))},setWindowHeight:function(t){e(M("windowHeight",{windowHeight:t}))},setGoodHeight:function(t){e(M("goodHeight",{goodHeight:t}))},setSearch:function(t){e(M("setSearch",{searchData:t}))},setSearchService:function(t){e(M("setSearchService",{service:t}))},setCorrection:function(t){e(M("setCorrection",{correction:t}))},setData:function(t,a,r){e(M("isLoad",{load:!1})),Q.search(t).then(function(t){if(0!==t.data.code)return e(M("setInit",{init:!0})),void e(M("isError",{errorState:!0}));e(M("isError",{errorState:!1})),t.data.data&&(a||(e(M("setInitItem",{result:t.data})),e(M("setInit",{init:!0}))),e(M("setCurrentPage",{current:t.data.data.page?t.data.data.page.current_page:1})),e(M("setTotalPage",{total:t.data.data.page?t.data.data.page.total_page:1})),e(M("setData",{result:t.data,filterUpdate:r})),e(M("isLoad",{load:!0})))}).catch(function(t){e(M("setInit",{init:!0})),D.tip.show({msg:t.message||t.response.data.message||"服务器繁忙"})})},toggleQuickSelect:function(t){e(M("toggleQuickSelect",{isQuickSelect:t}))}}}t.default=(0,S.connect)(te,ae)(q)}).call(this,a("OOjC"))},GKj9:function(e,t,a){},P9l9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.search=void 0;var r,i=a("mtWM"),s=(r=i)&&r.__esModule?r:{default:r};t.search=function(e){return s.default.post("/wapapi/search/items",e)}}}]);