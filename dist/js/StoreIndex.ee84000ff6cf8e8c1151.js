(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"GVI+":function(e,t,a){},"L8n+":function(e,t,a){"use strict";(function(e){var n=c(a("mvHQ")),r=c(a("Zx67")),l=c(a("kiBT")),o=c(a("OvRC")),s=c(a("pFYg")),i=c(a("C4MV")),u=c(a("woOf"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomService=t.StoreType=t.Footer=t.GoodsList=t.AdvertiseImage=t.CouponList=t.AppBanner=t.LeaderInfo=t.LeaderNav=t.StoreLeader=t.ConcernResult=t.StoreSign=t.PartingLine=t.SearchBar=t.StoreNotOpen=t.StoreIndex=void 0;var d=u.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.storeIndexState=W;var p=a("U7vG"),f=b(p),h=a("Zfgq"),v=a("4n+p"),_=a("d2xe"),g=b(a("4GUf")),E=a("f2Hk"),y=a("DOM9"),N=b(y),w=b(a("qAHI")),k=a("2uFj");function b(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,s.default)(t))&&"function"!=typeof t?e:t}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(l.default?(0,l.default)(e,t):e.__proto__=t)}a("GVI+");var I=w.default.CancelToken,T=(0,E.concatPageAndType)("storeIndex"),A={data:{url:k.MALLAPI+"/shop/shopIndex",method:"get"},addShop:{url:k.MALLAPI+"/user/saveShopCollection",method:"post"},removeShop:{url:k.MALLAPI+"/user/removeShopCollection",method:"get"},coupon:{url:k.MALLAPI+"/promotion/obtainCoupon",method:"post"}},R=t.StoreIndex=function(t){function a(e){S(this,a);var t=C(this,(a.__proto__||(0,r.default)(a)).call(this,e));return t.state={},document.title="店铺首页",t}return L(a,p.Component),m(a,[{key:"componentWillMount",value:function(){this.props.initialData()}},{key:"componentWillUnmount",value:function(){e(window).scrollTop(1)}},{key:"render",value:function(){var t=this.props,a=t.update,n=t.open_status,r=t.sign,l=t.subscribeAllow;return a?1===n||"1"===n?f.default.createElement("div",{"data-page":"store-index",style:{minHeight:e(window).height()}},f.default.createElement(M,d({query:this.props.location.query},r)),f.default.createElement(q,null),f.default.createElement(Z,{query:this.props.location.query,subscribeAllow:l}),f.default.createElement(D,this.props),f.default.createElement(U,this.props)):f.default.createElement("div",{"data-page":"store-index",style:{minHeight:e(window).height()}},f.default.createElement(x,r)):f.default.createElement(_.LoadingRound,null)}}]),a}(),x=t.StoreNotOpen=function(e){function t(){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.shop_alias_name,a=e.shop_name;return f.default.createElement("div",{className:"storeNotOpen"},f.default.createElement("img",{src:"../src/img/store/store-close-icon.png"}),f.default.createElement("div",{className:"notOpenDesc"},f.default.createElement("p",null,"抱歉，您访问的店铺：",t||a,"，"),f.default.createElement("p",null,"暂未开放，敬请谅解")),f.default.createElement("div",{className:"returnIndexButton"},f.default.createElement(h.Link,{to:"/homeIndex"},"返回商城首页")))}}]),t}(),M=t.SearchBar=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.changeHandle=function(e){a.value=e.target.value},a.clearHandle=function(){a.value?a.value="":a.setState({innerValue:""})},a.searchJump=function(){var e=k.RNDomain+"/searchResult?&module=TRMALL&page=searchResult&key="+(a.value||"")+"&shop="+a.props.query.shop;window.location.href=e},a.state={innerValue:e.defaultValue},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.value,t=this.state.innerValue;return f.default.createElement("form",{"data-comp":"search-bar-b",className:"g-row-flex",action:"javascript:;"},f.default.createElement("label",{className:"g-col-1 search-label",ref:"label"},f.default.createElement("input",{ref:"search",value:void 0!==e?e:t,type:"search",placeholder:"搜索店铺内商品",onChange:this.changeHandle,className:"search-input"}),""!=(void 0!==e?e:t)&&f.default.createElement("i",{ref:"clear",onTouchTap:this.clearHandle,className:"close-x-icon"}," "),f.default.createElement("i",{className:"search-icon"}," ")),f.default.createElement("button",{className:"search-btn",onClick:this.searchJump},"搜索"))}}]),t}(),q=t.PartingLine=function(e){function t(){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return L(t,p.Component),m(t,[{key:"render",value:function(){return f.default.createElement("div",{className:"partingLine"},f.default.createElement("img",{src:"../src/img/store/bar-parting-line.png"}))}}]),t}(),H=t.StoreSign=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.concernClick=function(e){a.props.subscribeAllow&&a.props.subscribeStore(e)},a.concernRender=function(e){return e?f.default.createElement("div",{className:"concerned"},f.default.createElement("span",null,"已关注")):f.default.createElement("div",{className:"noConcerned"},f.default.createElement("img",{src:"../src/img/store/follow-icon.png"}),f.default.createElement("span",null,"关注"))},a.jumpDetail=function(e,t,a){"self"!=t.shop_type&&a&&a.license_img&&h.browserHistory.push("/store/detail?shop="+e)},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.is_subscribe,a=e.sign,n=e.resultShow,r=e.shop_decoration_data,l=e.shop_extend_info,o=e.query,s=e.image_domain;o.shop;return f.default.createElement("div",{className:"storeSign container"},f.default.createElement("div",{className:"storeSignImage",onClick:this.jumpDetail.bind(this,r.shop_id,a,l)},f.default.createElement("img",{src:a.shop_logo?s+"/"+a.shop_logo:"../src/img/temporary/store_logo.png"})),f.default.createElement("div",{className:"storeSignInfo",onClick:this.jumpDetail.bind(this,r.shop_id,a,l)},f.default.createElement("p",{className:"storeSignInfoName"},a.shop_alias_name||a.shop_name),f.default.createElement("p",{className:"storeSignInfoDesc"},"泰然城精选商家 服务保障")),f.default.createElement("div",{className:"storeSignFollowButton",onClick:this.concernClick.bind(this,t)},this.concernRender(t),f.default.createElement(O,{state:t,resultShow:n})))}}]),t}(),O=t.ConcernResult=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.chooseResult=function(e){return e?f.default.createElement("div",{className:"concernSuccess"},f.default.createElement("img",{src:"../src/img/store/concern-result-icon.png"}),f.default.createElement("br",null),f.default.createElement("span",null,"关注成功"),f.default.createElement("p",null,"可到我的收藏内查看最新关注")):f.default.createElement("div",{className:"concernFailed"},f.default.createElement("img",{src:"../src/img/store/concern-result-icon.png"}),f.default.createElement("br",null),f.default.createElement("span",null,"取消关注"))},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.state;return f.default.createElement("div",{className:"concernResult "+(this.props.resultShow?"":"hide")},this.chooseResult(e))}}]),t}(),D=t.StoreLeader=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.setNav=function(e){a.setState({nav:e})},a.state={nav:1},a}return L(t,p.Component),m(t,[{key:"render",value:function(){return f.default.createElement("div",{className:"storeLeader","data-plugin":"swiper"},f.default.createElement(j,{state:this.state,setNav:this.setNav}),f.default.createElement(P,d({state:this.state},this.props)))}}]),t}(),j=t.LeaderNav=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.handleClick=function(e){a.props.setNav(e)},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.state.nav;return f.default.createElement("ul",{className:"leaderNav"},f.default.createElement("li",{className:1==e?"activeNav":"",onClick:this.handleClick.bind(this,1)},f.default.createElement("span",null,"店铺首页")),f.default.createElement("li",{className:2==e?"activeNav":"",onClick:this.handleClick.bind(this,2)},f.default.createElement("span",null,"全部商品")))}}]),t}(),P=t.LeaderInfo=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.factoryComponent=function(e,t,n,r){var l=a.props.image_domain;switch(e){case"slide":return f.default.createElement(B,{key:r,value:t,image:l});case"coupon":return n?f.default.createElement(G,{key:r,value:t}):"";case"floor_single":return f.default.createElement(V,{key:r,value:t,img:l});case"floor":return f.default.createElement(F,{key:r,value:t,img:l})}},a.factoryArray=function(e,t,n){if(e.length==t.length){for(var r=[],l=0;l<e.length;l++)r.push(a.factoryComponent(e[l],t[l],n,l));return r}},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.state.nav,t=this.props,a=t.update,n=t.shop_decoration_data,r=n.modules,l=n.is_show_coupon,o=this.props.sign.shop_attr,s=r&&r.map(function(e){return e.module_type});return f.default.createElement("div",{className:"leaderInfo"},1==e?a?r&&r.length?f.default.createElement("div",{className:"storeIndexItem"},s&&this.factoryArray(s,r,l)):f.default.createElement("div",{className:"allGoodsItem"},f.default.createElement(N.default,d({},this.props,{storeHomeRequest:"true",shop_attr:o}))):f.default.createElement(_.LoadingRound,null):"",2==e?f.default.createElement("div",{className:"allGoodsItem"},f.default.createElement(N.default,d({},this.props,{storeHomeRequest:"true",shop_attr:o}))):"")}}]),t}(),B=t.AppBanner=function(e){function t(e){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return L(t,p.Component),m(t,[{key:"componentDidMount",value:function(){new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationType:"fraction",loop:!0,autoplay:2e3,lazyLoading:!0})}},{key:"render",value:function(){var e=this.props.value.module_data,t=this.props.image;return f.default.createElement("div",{className:"appBanner swiper-container"},f.default.createElement("ul",{className:"swiper-wrapper"},e.map(function(e,a){return f.default.createElement("li",{className:"swiper-slide",key:a},f.default.createElement("a",{href:e.link},f.default.createElement("img",{src:t+"/"+e.image})))})),f.default.createElement("div",{className:"swiper-pagination custom-pagination"}))}}]),t}(),G=t.CouponList=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.clickHandle=function(e){w.default.request(d({},A.coupon,{data:{coupon_id:e,source:"activity",description:""}})).then(function(e){0===e.data.code?g.default.MsgTip({msg:"领取成功"}):(401==e.data.code&&(window.location.href="/login"),g.default.MsgTip({msg:e.data.msg}))}).catch(function(e){g.default.MsgTip({msg:e.response.data.message})})},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this,t=this.props.value.module_data.map(function(t,a){return f.default.createElement("li",{className:"coupon",key:a},f.default.createElement("div",{className:"couponLeft"},f.default.createElement("p",{className:"couponNum"},"￥",f.default.createElement("span",null,t.deduct_money)),f.default.createElement("p",{className:"couponLimit"},"满",f.default.createElement("span",null,t.limit_money),"使用")),f.default.createElement("div",{className:"couponRight"},f.default.createElement("p",{className:"couponText"},"优惠券"),f.default.createElement("span",{className:"couponButton",onClick:e.clickHandle.bind(e,t.id)},"点击领取")))});return f.default.createElement("ul",{className:"couponList"},t)}}]),t}(),V=t.AdvertiseImage=function(e){function t(e){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.value.module_data,t=this.props.img;return f.default.createElement("div",{className:"advertiseImage"},e.map(function(e,a){return f.default.createElement("a",{key:a,href:e.link},f.default.createElement("img",{src:t+"/"+e.image}))}))}}]),t}(),F=t.GoodsList=function(t){function a(e){S(this,a);var t=C(this,(a.__proto__||(0,r.default)(a)).call(this,e));return t.tradeTypeObj={10:"国内贸易",20:"海淘",30:"跨境保税",40:"海外直邮"},t.tagStyleObj={10:"hide",20:"tag_yellow",30:"tag_blue",40:"tag_yellow"},t}return L(a,p.Component),m(a,[{key:"componentDidMount",value:function(){e(window).scrollTop(1)}},{key:"render",value:function(){var e=this.tradeTypeObj,t=this.tagStyleObj,a=this.props.value.module_name,n=this.props.value.module_data,r=this.props.img,l=n.map(function(a,n){var l=a.primary_image,o=a.id,s=a.current_store,i=a.promotion_tag,u=a.market_price,c=a.title,d=s<=0;return f.default.createElement("li",{className:"goods",key:n},f.default.createElement("a",{href:k.RNDomain+"/item?item_id="+o},f.default.createElement("div",{className:"goodsImage"},f.default.createElement("img",{src:r+"/"+l}),d?f.default.createElement("div",{className:"float-label"},f.default.createElement("img",{src:"/src/img/search/sale-out-big.png"})):""),f.default.createElement("p",{className:"goodsDesc"},c),f.default.createElement("p",{className:"goodsPrice"},f.default.createElement("span",{className:"nowPrice"},"￥",a.activity_price||a.sell_price),f.default.createElement("span",{className:"oldPrice"},"￥",u)),f.default.createElement("ul",{className:"goodsTag"},f.default.createElement("li",{className:t[a.trade_type],key:"tagType1"},f.default.createElement("span",null,e[a.trade_type])),(i||[]).map(function(e,t){return f.default.createElement("li",{className:"tag_red",key:t},f.default.createElement("span",null,e))}))))});return f.default.createElement("div",{className:"goodsList"},f.default.createElement("div",{className:"title"},a||"今日特卖"),f.default.createElement("ul",{className:"content container"},l))}}]),a}(),U=t.Footer=function(e){function t(e){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return L(t,p.Component),m(t,[{key:"render",value:function(){return f.default.createElement("ul",{className:"footer"},f.default.createElement(J,this.props))}}]),t}(),J=(t.StoreType=function(e){function t(e){S(this,t);var a=C(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.clickHandle=function(){a.setState({hide:!a.state.hide})},a.state={hide:!0},a}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.shop_cat_list,a=e.shop_decoration_data,n=this.state.hide;return f.default.createElement("li",{className:"storeType",onClick:this.clickHandle},f.default.createElement("img",{src:"../src/img/store/store-type-icon.png"}),f.default.createElement("span",null,"商品分类"),f.default.createElement("div",{className:"storeList "+(n?"hide":"")},f.default.createElement("ul",{className:"storeListBody"},t.map(function(e,t){return f.default.createElement("li",{key:t},f.default.createElement(h.Link,{className:"storeListLink",to:"/searchResult?shop="+a.shop_id+"&category="+e.cat_id},e.cat_name))})),f.default.createElement("div",{className:"storeListIcon"})))}}]),t}(),t.CustomService=function(e){function t(e){return S(this,t),C(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return L(t,p.Component),m(t,[{key:"render",value:function(){var e=this.props.sign.shop_attr;return f.default.createElement("li",{className:"customService"},f.default.createElement(_.CustomerService,{className:"save",shopAttr:e},f.default.createElement("img",{src:"../src/img/store/custom-service-icon.png"}),f.default.createElement("span",null,"联系客服")))}}]),t}());function W(e){return d({},e.searchResult3,e.storeIndex)}var Z=(0,v.connect)(W,function(e,t){return{subscribeStore:function(a){e(T("subscribeAllow",{state:!1}));var r=void 0;r=a?d({},A.removeShop,{params:{shop_id:(0,n.default)([t.query.shop])}}):d({},A.addShop,{data:{shop_id:t.query.shop}}),w.default.request(d({},r,{cancelToken:new I(function(e){e})})).then(function(t){e(T("subscribeAllow",{state:!0})),0!==t.data.code?(401==t.data.code&&(window.location.href="/login"),g.default.MsgTip({msg:t.data.msg})):(e(T("subscribeStore",{state:!a})),e(T("resultShow",{resultShow:!0})),setTimeout(function(){e(T("resultShow",{resultShow:!1}))},3e3))}).catch(function(t){e(T("subscribeAllow",{state:!0})),console.log(t)})}}})(H);t.default=(0,v.connect)(W,function(e,t){return d({},(0,y.searchResultDispatch)(e,t),{initialData:function(){var a=t.location.query.shop;e(T("dataUpdate",{update:!1})),w.default.request(d({},A.data,{params:{shop_id:a},cancelToken:new I(function(e){e})})).then(function(t){0===t.data.code&&(e(T("initialData",{value:t.data.data})),e(T("dataUpdate",{update:!0})))}).catch(function(e){console.log(e)})}})})(R)}).call(this,a("OOjC"))}}]);