(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"3fLG":function(t,e,a){"use strict";(function(t){var n=c(a("Zx67")),o=c(a("kiBT")),r=c(a("OvRC")),i=c(a("pFYg")),l=c(a("C4MV")),s=c(a("woOf"));function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var u=s.default||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},p=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,l.default)(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.ItemPageState=N,e.ItemPageDispatch=C;var d=a("U7vG"),f=b(d),m=a("4n+p"),h=a("Zfgq"),v=a("f2Hk"),y=b(a("qAHI")),g=a("d2xe"),_=(a("fw66"),a("f2t5"));a("nztU");a("kjFZ");b(a("JmOZ")),b(a("m9/l")),b(a("Wkbk"));function b(t){return t&&t.__esModule?t:{default:t}}var E={Detail:{url:"/originapi/itemNew/detail",method:"get"},Mix:{url:"/originapi/itemNew/mix",method:"get"},Promotion:{url:"/originapi/itemNew/promotion",method:"get"},Rate:{url:"/originapi/itemNew/rate",method:"get"},Recommend:{url:"/originapi/itemNew/recommend",method:"get"},GetCart:{url:"/originapi/h5/cart/count",type:"get"}},k=(0,v.actionAxios)("itemIndex"),w=(0,v.concatPageAndType)("itemIndex");var S=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||(0,n.default)(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,i.default)(e)));t.prototype=(0,r.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}(e,d.Component),p(e,[{key:"componentWillMount",value:function(){var t=this.props.location.query.mini;(0,_.redirectURL)(location.pathname+location.search,t),document.title="商品详情",this.props.location.query.item_id||h.browserHistory.push("/")}},{key:"render",value:function(){return f.default.createElement(g.EmptyPage,{config:{bgImgUrl:"/src/img/shopCart/item-noexist-icon.png",msg:"该页面不存在，请打开APP或者前往微信商城查看",noBtn:!0}})}}]),e}();function N(t,e){return u({},t.itemIndex)}function C(t,e){window.location.href.split("#")[0];return{InitAndClearData:function(){t(w("initAndClearData"))},Detail:function(e){y.default.request(u({},E.Detail,{params:{item_id:e}})).then(function(a){a.data.status?(t(w("changeUpdata",{updata:!0,itemId:e})),t(w("initData",{data:a.data.data,status:!0})),t(k("recommendData",u({},E.Recommend,{params:{item_id:e,category_id:a.data.data.category_id,shop_id:a.data.data.shop.shop_id}}))),t(k("mixData",u({},E.Mix,{params:{item_id:e}})))):t(w("changeUpdata",{updata:!0}))}).catch(function(t){console.log(t)})},Promotion:function(e){t(k("promotionData",u({},E.Promotion,{params:{item_id:e}})))},Rate:function(e){t(k("rateData",u({},E.Rate,{params:{item_id:e}})))},GetCart:function(){t(k("cartInfoData",E.GetCart))},UpdateBuyModal:function(e){t(w("updateBuyModal",e))},InitState:function(e){t(w("initState",{ret:e}))},UpdateCartInfo:function(e){t(w("updateCartInfo",e))}}}e.default=(0,m.connect)(N,C)(S)}).call(this,a("OOjC"))},"4I33":function(t,e,a){"use strict";var n,o=l(a("Zzip")),r=l(a("pFYg")),i=l(a("5QVw"));function l(t){return t&&t.__esModule?t:{default:t}}var s,c="function"==typeof i.default&&"symbol"===(0,r.default)(o.default)?function(t){return void 0===t?"undefined":(0,r.default)(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":(0,r.default)(t)};s="undefined"!=typeof window?window:void 0,void 0===(n=function(){return function(t,e){if(void 0===t)throw new Error("Geetest requires browser environment");var a=t.document,n=t.Math,o=a.getElementsByTagName("head")[0];function r(t){this._obj=t}function i(t){var e=this;new r(t)._each(function(t,a){e[t]=a})}r.prototype={_each:function(t){var e=this._obj;for(var a in e)e.hasOwnProperty(a)&&t(a,e[a]);return this}},i.prototype={api_server:"api.geetest.com",protocol:"http://",type_path:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){return l(this.type)?this.fallback_config[this.type]:this.new_captcha?this.fallback_config.fullpage:this.fallback_config.slide},_extend:function(t){var e=this;new r(t)._each(function(t,a){e[t]=a})}};var l=function(t){return"string"==typeof t},s={},u={},p=function(t,e,a,n){e=function(t){return t.replace(/^https?:\/\/|\/$/g,"")}(e);var o=function(t){return 0!==(t=t.replace(/\/+/g,"/")).indexOf("/")&&(t="/"+t),t}(a)+function(t){if(!t)return"";var e="?";return new r(t)._each(function(t,a){(l(a)||function(t){return"number"==typeof t}(a)||function(t){return"boolean"==typeof t}(a))&&(e=e+encodeURIComponent(t)+"="+encodeURIComponent(a)+"&")}),"?"===e&&(e=""),e.replace(/&$/,"")}(n);return e&&(o=t+e+o),o},d=function(t,e,n,r,i){!function l(s){var c=p(t,e[s],n,r);!function(t,e){var n=a.createElement("script");n.charset="UTF-8",n.async=!0,n.onerror=function(){e(!0)};var r=!1;n.onload=n.onreadystatechange=function(){r||n.readyState&&"loaded"!==n.readyState&&"complete"!==n.readyState||(r=!0,setTimeout(function(){e(!1)},0))},n.src=t,o.appendChild(n)}(c,function(t){t?s>=e.length-1?i(!0):l(s+1):i(!1)})}(0)},f=function(e,a,o,r){if("object"===(void 0===(i=o.getLib)?"undefined":c(i))&&null!==i)return o._extend(o.getLib),void r(o);var i;if(o.offline)r(o._get_fallback_config());else{var l="geetest_"+(parseInt(1e4*n.random())+(new Date).valueOf());t[l]=function(e){"success"===e.status?r(e.data):e.status?r(o._get_fallback_config()):r(e),t[l]=void 0;try{delete t[l]}catch(t){}},d(o.protocol,e,a,{gt:o.gt,callback:l},function(t){t&&r(o._get_fallback_config())})}},m=function(t,e){var a={networkError:"网络错误"};if("function"!=typeof e.onError)throw new Error(a[t]);e.onError(a[t])};t.Geetest&&(u.slide="loaded");var h=function(e,a){var n=new i(e);e.https?n.protocol="https://":e.protocol||(n.protocol=t.location.protocol+"//"),f([n.api_server||n.apiserver],n.type_path,n,function(e){var o=e.type,r=function(){n._extend(e),a(new t.Geetest(n))};s[o]=s[o]||[];var i=u[o]||"init";"init"===i?(u[o]="loading",s[o].push(r),d(n.protocol,e.static_servers||e.domains,e[o]||e.path,null,function(t){if(t)u[o]="fail",m("networkError",n);else{u[o]="loaded";for(var e=s[o],a=0,r=e.length;a<r;a+=1){var i=e[a];"function"==typeof value&&i()}s[o]=[]}})):"loaded"===i?r():"fail"===i?m("networkError",n):"loading"===i&&s[o].push(r)})};return t.initGeetest=h,h}(s)}.call(e,a,e,t))||(t.exports=n)},"H+oF":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.onAreaResultJSBrige=function(t,e){return function(a){a=JSON.parse(a);var n=void 0,o=void 0;n=/110100|120100|500100|310100/.test(a.provinceCode)?a.provinceName+a.cityName:a.cityName+a.countyName,o=function(t,e){var a=t,n="";if(!0===a)return!0;for(var o in a)n+=","+a[o].area;return n=n.split(","),e.some(function(t,e){return n.indexOf(t)>-1})}(t,[a.provinceCode,a.cityCode,a.countyCode].filter(function(t){return t})),e&&e(n,o)}}},"m9/l":function(t,e,a){"use strict";(function(t){var n=u(a("fZjL")),o=u(a("Zx67")),r=u(a("kiBT")),i=u(a("OvRC")),l=u(a("pFYg")),s=u(a("C4MV")),c=u(a("woOf"));function u(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PriceArea=e.createChooseSpec=e.Buy=void 0;var p=c.default||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},d=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),f=a("U7vG"),m=M(f),h=M(a("O27J")),v=a("Zfgq"),y=a("4n+p"),g=a("f2Hk"),_=a("rsfq"),b=a("f2t5"),E=a("d2xe"),k=(a("H+oF"),a("fw66")),w=a("G+/1"),S=a("0p2n"),N=a("daIj"),C=(M(a("mtWM")),a("JmOZ")),x=a("JmOZ");function M(t){return t&&t.__esModule?t:{default:t}}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,l.default)(e))&&"function"!=typeof e?t:e}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,l.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r.default?(0,r.default)(t,e):t.__proto__=e)}var D=(0,g.concatPageAndType)("seckill"),A=(0,g.actionAxios)("seckill"),L=function(t){function e(){var t,a,r;P(this,e);for(var i=arguments.length,l=Array(i),s=0;s<i;s++)l[s]=arguments[s];return a=r=I(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(l))),r.initList=function(){var t=r.props.promotion.info.specs;return(0,n.default)(t).map(function(e,a){return m.default.createElement(x.Specs,p({specs:t[e],index:a},r.props,{key:a}))})},r.getLimit=function(){var t=r.props.data.activity_type,e=r.props.promotion.itemRules;return"seckill"===t?m.default.createElement("span",{className:"limit_buy"},"限购",e.user_buy_limit,"件 (已购",e.user_buy_count,"件)"):null},I(r,a)}return T(e,f.Component),d(e,[{key:"render",value:function(){var t=this.props.retState,e=t.num,a=t.storeNum;return m.default.createElement("div",{className:"attr-wrap"},m.default.createElement("div",{className:"standard-area stable-standard cur"},m.default.createElement("div",{className:"standard-info"},this.initList())),m.default.createElement("div",{className:"buy-amount"},m.default.createElement("span",{className:"amount-tit"},"数量："),m.default.createElement("span",{className:"number-increase-decrease"},m.default.createElement("span",{className:"btn btn-action action-decrease dis-click"},"－"),m.default.createElement("input",{type:"number",readOnly:!0,className:"action-quantity-input",value:e}),m.default.createElement("span",{className:"btn btn-action action-increase dis-click"},"＋")),m.default.createElement("span",{className:"store_buy"},"库存",a,"件"),this.getLimit(),m.default.createElement("div",{className:"clearfix"})),m.default.createElement(x.ExpectTax,this.props))}}]),e}(),O=function(t){function e(){return P(this,e),I(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return T(e,f.Component),d(e,[{key:"render",value:function(){var t=this.props,e=t.onClickBuy,a=(t.purchaseLimit,t.toBuyClick),n=t.isNonPayment,o=t.isLimit,r=t.popTips,i=t.state;return m.default.createElement("div",{className:"buy-option-btn"},null,n?m.default.createElement("div",{type:"button",className:"btn-tobuy-disable"},"还有机会"):m.default.createElement("div",null,2==i?o()?m.default.createElement("div",{className:"btn-tobuy ",onTouchTap:a?e:""},"确定"):m.default.createElement("div",{className:"btn-tobuy-disable"},"确定"):m.default.createElement("div",{className:"action-notify",onTouchTap:function(){return r("秒杀还未开始，请耐心等待哦~")}},"即将开始")))}}]),e}(),R=function(t){function e(t){P(this,e);var a=I(this,(e.__proto__||(0,o.default)(e)).call(this,t));return a.changeBusinessPrice=function(){var t=a.props.retState,e=t.nowPrice,o=t.nowSkuId,r=t.storeNum,i=a.props.promotion.info.skus,l=(0,n.default)(i)[0];o=i[l].sku_id,r=i[l].store;var s=p({},a.props.retState,{nowPrice:e,nowSkuId:o,storeNum:r});a.props.InitState(s)},a.purchaseLimit=function(){var t=a.props.data.trade_type;if(a.props.retState.num>1&&a.props.retState.nowSkuId&&(0,_.PurchaseLimit)(t))return a.props.retState.num*a.props.retState.nowPrice>2e3},a.getActionData=function(t){var e=a.props,n=e.itemId,o=e.retState,r=e.promotion,i=a.props.mix&&a.props.mix.addrList,l=i&&(i.recent_addr.length>0&&i.recent_addr[0].addr_id||i.default_addr&&i.default_addr.addr_id)||0,s={"item[item_id]":n,"item[quantity]":o.num,"item[sku_id]":o.nowSkuId,obj_type:"seckill",in_promotion_time:r.promotion[0].in_promotion_time},c=a.props.location.query.user_id;return c&&(s.commission_user_id=c),t&&(s.mode="fast_buy",s.addr_id=l),s},a.onClickBuy=function(){var t=a.checkSpec();t?S.tip.show({msg:"请选择"+t}):a.toCart()},a.toCart=function(){a.props.PopupModal(!0),a.props.loadCaptcha(a)},a.isHasStore=function(t,e,a){return e&&e.some(function(e,n){if(e.ids[t.index]===t.spec){var o=a.slice();return o[t.index]&&delete o[t.index],!!o.every(function(t,n){return a[n]===e.ids[n]})&&e.skus.store>0}return!1})},a.specSelect=function(t,e,n){var o,r=a.props.retState,i=a.props.promotion.info.skus,l=a.props.promotion.store,s=r.selectArr,c=r.specKey,u=r.nowSku,d=r.storeNum,f=r.newData,m=r.nowSkuId,h=r.nowPrice,v=r.num;(s=s.slice())[e]===t?(delete s[e],delete c[e]):(s[e]=t,c[e]=n),o=s.join("_"),s.length==f[0].ids.length&&i[o]?(u=i[o],m=i[o].sku_id,h=i[o].price,v=v<(d=i[o].store)?v:d):(h=(0,x.rangePrice)(a.props.promotion,!0),d=l.real,m="",u="");var y=p({},a.props.retState,{nowSku:u,selectArr:s,specKey:c,nowSkuId:m,nowPrice:h,num:v,storeNum:d});a.props.InitState(y)},a.judgeSingleSku=function(){var t=a.props.promotion.info.skus;return 1===(0,n.default)(t).length},a.singleSku=function(){var t=a.props.promotion.info,e=t.skus,o=t.specs,r=(0,n.default)(e)[0],i=a.props.retState,l=i.selectArr,s=i.specKey,c=(i.newData,i.nowSkuId),u=i.nowPrice;c=e[r].sku_id,u=e[r].price,l=r.split("_"),s=(0,n.default)(o);var d=p({},a.props.retState,{selectArr:l,specKey:s,nowSkuId:c,nowPrice:u});a.props.InitState(d)},a.state={toBuyClick:!0},a}return T(e,f.Component),d(e,[{key:"componentWillMount",value:function(){this.judgeSingleSku()&&this.changeBusinessPrice()}},{key:"checkSpec",value:function(){var t=this.props.retState,e=t.specKey,a=t.nowSkuId,o=this.props.promotion.info.specs;return!(a||o instanceof Array)&&o[(0,n.default)(o).filter(function(t,a){return+t!==e[a]})[0]].name}},{key:"render",value:function(){var t=p({isHasStore:this.isHasStore,onClickBuy:this.onClickBuy,specSelect:this.specSelect,judgeSingleSku:this.judgeSingleSku,purchaseLimit:this.purchaseLimit},this.props,this.state);return m.default.createElement(w.NewModal,{isOpen:this.props.buyModal,onClose:this.props.closeModal},m.default.createElement("div",{className:"action-buy-modal"},m.default.createElement(x.BuyModalTitle,t),m.default.createElement(L,t),m.default.createElement(O,t)))}}]),e}(),B=e.Buy=function(t){function e(){var t,a,n;P(this,e);for(var r=arguments.length,i=Array(r),l=0;l<r;l++)i[l]=arguments[l];return a=n=I(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(i))),n.active=function(t){n.props.UpdateBuyModal({buyModal:!0,buyActive:t})},n.closeModal=function(){n.props.UpdateBuyModal({buyModal:!1})},n.isNonPayment=function(){if(n.props.promotion.itemRules){var t=n.props.promotion.itemRules,e=t.real_store,a=t.item_sales,o=t.sales_count;if(!e)return a!==o}},n.isLimit=function(){var t=n.props.promotion;return t.itemRules.user_buy_limit>t.itemRules.user_buy_count},I(n,a)}return T(e,f.Component),d(e,[{key:"componentWillReceiveProps",value:function(t){t.mixStatus&&t.proStatus&&this.setState({mixStatus:t.mixStatus,proStatus:t.proStatus})}},{key:"popTips",value:function(t){S.tip.show({msg:t})}},{key:"render",value:function(){var t=this,e=p({},this.props,{isNonPayment:this.isNonPayment(),isLimit:this.isLimit,popTips:this.popTips,closeModal:this.closeModal});return e.mixStatus&&e.proStatus?m.default.createElement("div",null,this.props.choose?m.default.createElement("div",null,"chooseSpec"===this.props.buyActive&&m.default.createElement(R,e),m.default.createElement(E.LinkChange,{className:"choose-btn",onClick:function(){t.active("chooseSpec")}}," ")):this.props.data.is_charge?null:"Shelves"===this.props.data.status?this.isNonPayment()?m.default.createElement("div",{className:"action-btn-group c-fr"},m.default.createElement(E.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"还有机会")):this.props.promotion.itemRules.real_store?m.default.createElement("div",{className:"action-btn-group  c-fr seckill-btn"},"buy"===this.props.buyActive&&m.default.createElement(R,e),2==this.props.state?this.isLimit()?m.default.createElement("div",null,m.default.createElement(E.LinkChange,{className:"ui-btn  action-addtocart  action-btn-seckill-in c-fl",onClick:function(e){t.active("buy")}},"立即秒杀")):m.default.createElement(E.LinkChange,{className:"ui-btn  action-addtocart  action-btn-seckill-disable c-fl"},"立即秒杀"):1==this.props.state?m.default.createElement(E.LinkChange,{className:"ui-btn  action-notify"},"秒杀结束"):m.default.createElement(E.LinkChange,{className:"ui-btn  action-notify",onTouchTap:function(){return t.popTips("秒杀还未开始，请耐心等待哦~")}},"即将开始")):m.default.createElement("div",{className:"action-btn-group c-fr"},m.default.createElement(E.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"已售罄")):m.default.createElement("div",{className:"action-btn-group c-fr"},m.default.createElement(E.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"已下架"))):m.default.createElement("div",{className:"action-btn-group c-fr"},m.default.createElement("span",{className:"ui-btn  action-buy-now c-fl incomplete-buy-now",style:{width:"100%"}},"立即秒杀"))}}]),e}(),j=(0,x.createBuyAction)({Buy:B}),U=(e.createChooseSpec=function(t){var e=t.Buy;return function(t){function a(){return P(this,a),I(this,(a.__proto__||(0,o.default)(a)).apply(this,arguments))}return T(a,N.PureComponent),d(a,[{key:"render",value:function(){var t=this.props.promotion.info.specs,a=this.props,n=a.retState,o=a.data,r=a.promotion,i=(0,x.chooseSpec)(n,t);return"Shelves"===o.status||r.store.real?!(t instanceof Array)&&m.default.createElement("div",{className:"choose-col"},m.default.createElement("ul",{className:"choose-spec c-fs13"},m.default.createElement("li",{className:"c-mr15"},i.length>0&&n.nowSkuId?"已选择 ":"选择 "),i.length>0&&n.nowSkuId&&m.default.createElement("li",{className:"c-mr15"},(0,x.chooseSpec)(n,t)),m.default.createElement("li",{className:"icon"},m.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"}))),m.default.createElement(e,p({},this.props,{choose:!0})),m.default.createElement("div",{className:"gap bgf4"})):null}}]),a}()})({Buy:B}),V=e.PriceArea=function(t){function e(){return P(this,e),I(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return T(e,N.PureComponent),d(e,[{key:"render",value:function(){var t=this.props,e=t.data,a=t.proStatus,n=t.promotion,o=t.state;return m.default.createElement("div",{className:"price-area"},!o&&m.default.createElement(x.Price,{item:e,proStatus:a,promotion:n}),m.default.createElement(x.GoodsTit,{item:e}),m.default.createElement(x.Tag,{item:e}))}}]),e}(),q=function(t){function e(){return P(this,e),I(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return T(e,N.PureComponent),d(e,[{key:"componentWillMount",value:function(){var t=this,e=this.props.promotion.promotion[0],a=e.now_time,n=e.end_time,o=e.start_time;this.props.initData({now_time:a,end_time:n,start_time:o}),this.timer=setInterval(function(){t.props.observeState()},1e3)}},{key:"componentWillReceiveProps",value:function(t){1==t.state&&location.reload()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.timer=null,this.props.clearData()}},{key:"formatTime",value:function(t){return b.dateUtil.formatNum(parseInt(t))}},{key:"render",value:function(){var t=this.props,e=t.state,a=t.toend,n=t.data,o=t.proStatus,r=t.promotion;return 1==e?null:m.default.createElement("div",{className:"detail-seckil-state-area"},m.default.createElement("div",{className:"seckil-state-area-l c-fl"},m.default.createElement(x.Price,{item:n,proStatus:o,promotion:r}),2==e?m.default.createElement("span",{className:"in-seckil c-tc c-dpib"},"秒杀中"):null),e?m.default.createElement("div",{className:"seckil-state-area-r-in c-fr"},m.default.createElement("div",null,m.default.createElement("div",{className:"c-dpb c-tc"},"离结束还剩"),m.default.createElement("div",{className:"time-remain c-tc"},m.default.createElement("div",{className:"c-dpib"},m.default.createElement("font",null,this.formatTime(a/3600)),":",m.default.createElement("font",null,this.formatTime(a%3600/60)),":",m.default.createElement("font",null,this.formatTime(a%60)))))):m.default.createElement("div",{className:"seckil-state-area-r-no c-fr"},"预计",b.dateUtil.format(1e3*this.props.start_time,"M月D日H:F:S"),"开始"))}}]),e}(),G=function(t){function e(){return P(this,e),I(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return T(e,N.PureComponent),d(e,[{key:"getInput",value:function(t){this.props.validVal(t.target.value)}},{key:"createMsg",value:function(){var t=this;return m.default.createElement("div",{className:"seckill-code-content"},m.default.createElement("h2",null,"请输入验证码"),m.default.createElement("div",{className:"code-input-area"},m.default.createElement("input",{type:"text",value:this.props.inputVal,placeholder:"请输入验证码",onChange:function(e){return t.getInput(e)}}),m.default.createElement("img",{className:"get-code",src:this.props.valid.primary_image,onClick:function(){t.props.validStatus&&t.props.loadCaptcha(),t.props.changeVaildStatus(!1)}}),this.props.validError?m.default.createElement("span",{className:"error"},this.props.errorVal):null))}},{key:"closeModal",value:function(){this.setState({}),this.props.PopupModal(!1)}},{key:"onSure",value:function(){if(!this.props.inputVal)return this.props.validError("请输入验证码");this.props.checkCaptcha(this.props.inputVal)}},{key:"resetScroll",value:function(){setTimeout(function(){document.body.scrollTop+=1},100)}},{key:"render",value:function(){var t=this;return m.default.createElement(k.ModalTips,{isOpen:this.props.popupModalCtrl.show,msg:this.createMsg(),onClose:function(){t.closeModal(),t.resetScroll()},onSure:function(){t.onSure(),t.resetScroll()},className:"modal-seckill-code"})}}]),e}(),H=function(t){function e(){return P(this,e),I(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return T(e,N.PureComponent),d(e,[{key:"render",value:function(){return m.default.createElement("div",{className:"active-area"},m.default.createElement(x.PromotionWrap,this.props))}}]),e}(),W=function(e){function a(e){P(this,a);var n=I(this,(a.__proto__||(0,o.default)(a)).call(this,e));return n.scrollEvent=function(){var e=n.refs,a=e.scrollImage,o=e.screenRate,r=e.screenDetail,i=e.itemNav;a=h.default.findDOMNode(a),i=h.default.findDOMNode(i),window.removeEventListener("scroll",n.addScrollEvent),n.addScrollEvent=function(){var e=document.body.scrollTop,l=e/(t(a).height()-44);l=l>=1?1:l,n.setState({ratio:l});var s=n.state;t(i).css({display:l?"block":"none",backgroundColor:"rgba(255,255,255,"+l+")",color:"rgba(53,53,53,"+l+")"}),e<o.offsetTop-44?0!==s&&n.setState({index:0}):e<r.offsetTop-44?1!==s&&n.setState({index:1}):2!==s&&n.setState({index:2})},window.addEventListener("scroll",n.addScrollEvent)},n.navClick=function(e){var a=n.refs,o=a.screenRate,r=a.screenDetail;0===e?t(window).scrollTop(0):1===e?t(window).scrollTop(o.offsetTop-44):t(window).scrollTop(r.offsetTop-44)},n.state={index:0},n}return T(a,f.Component),d(a,[{key:"componentDidMount",value:function(){this.scrollEvent()}},{key:"componentDidUpdate",value:function(){this.scrollEvent()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.addScrollEvent)}},{key:"render",value:function(){var t=this.props,e=t.location,a=t.data,n=t.mix,o=t.rate,r=t.recommend,i=t.promotion,l=t.cartNum,s=t.isLogin,c=t.pending,u=t.mixStatus,d=t.rateStatus,f=t.recommendStatus,h=t.proStatus,v=t.cartInfoStatus,y=t.retState,g=t.areaData,_=t.UpdateBuyModal,b=t.InitState,E=t.UpdateCartInfo,k=t.buyModal,w=t.buyActive,S=a.item_id,N=this.props,M=N.initData,P=N.observeState,I=N.clearData,T=N.state,D=N.toend,A=N.start_time,L={itemId:S,location:e,retState:y,data:a,mix:n,promotion:i,mixStatus:u,proStatus:h,UpdateBuyModal:_,InitState:b,UpdateCartInfo:E,buyModal:k,buyActive:w,PopupModal:N.PopupModal,loadCaptcha:N.loadCaptcha,state:T},O={promotion:i,initData:M,observeState:P,clearData:I,state:T,toend:D,start_time:A};return m.default.createElement("div",{"data-page":"item-detail",id:"item-details",ref:"details"},m.default.createElement(C.BarrageStripConnnect,null),m.default.createElement(x.ItemNav,{ref:"itemNav",index:this.state.index,navClick:this.navClick,ratio:this.state.ratio}),m.default.createElement("div",{ref:"screenItem",className:"screenItem"},m.default.createElement(x.ScrollImageState,{data:a,ref:"scrollImage"}),h&&m.default.createElement(q,p({},O,{data:a,proStatus:h,promotion:i})),m.default.createElement(V,{data:a,proStatus:h,promotion:i,state:T}),h&&m.default.createElement(H,{promotion:i,shop:a.shop}),m.default.createElement("div",{className:"gap bgf4"}),u&&h&&m.default.createElement(U,L),u&&m.default.createElement(x.SeverArea,{mix:n,data:a,retState:y,areaData:g,isLogin:s,pending:c}),m.default.createElement("div",{className:"gap bgf4"})),m.default.createElement("div",{ref:"screenRate"},d&&m.default.createElement(x.EvaluateArea,{rate:o,itemId:S}),m.default.createElement("div",{className:"gap bgf4"}),f&&m.default.createElement(x.RecommendArea,{recommend:r}),m.default.createElement("div",{className:"gap bgf4"}),m.default.createElement(x.ShopArea,{shop:a.shop})),m.default.createElement("div",{ref:"screenDetail"},m.default.createElement(x.GoodsDetail,{data:a})),m.default.createElement(j,p({cartNum:l,cartInfoStatus:v},L)),m.default.createElement(G,this.props))}}]),a}();e.default=(0,y.connect)(function(t){return p({},t.seckill)},function(e){var a=!1,n=void 0;return{clearData:function(){e(D("clearData",{}))},initData:function(t){e(D("initData",t))},observeState:function(){e(D("observeState",{}))},PopupModal:function(t){e(D("popupModalCtrl",{popupModalCtrl:{show:t}})),e(D("clearCaptcha",{})),a=!1},loadCaptcha:function(t){t&&(n=t),e(A("loadCaptcha",{url:"/wxapi/loadCaptcha.api"}))},changeVaildStatus:function(t){e(D("changeVaildStatus"))},validError:function(t){e(D("validError",{errorVal:t}))},validVal:function(t){e(D("validVal",{inputVal:t}))},checkCaptcha:function(o){var r=this;if(!a){a=!0;var i=n.getActionData(!0);i.captcha_code=o,t.ajax((0,x.Action)("toCart",{data:i,success:function(t){if(a=!1,1001==t.biz_code)return r.validError(t.msg),e(D("validVal",{inputVal:""})),void r.loadCaptcha();if(r.PopupModal(!1),t.status){var n=t.data.buy_type;v.browserHistory.push("/orderConfirm?mode=fast_buy&buy_type="+n)}}}))}}}})(W)}).call(this,a("OOjC"))},"t/Wd":function(t,e,a){"use strict";
/*! fly - v1.0.0 - 2014-12-22
* https://github.com/amibug/fly
* Copyright (c) 2014 wuyuedong; Licensed MIT */var n;(n=Zepto).fly=function(t,e){var a={version:"1.0.0",autoPlay:!0,vertex_Rtop:20,speed:1.2,start:{},end:{},onEnd:n.noop},o=this,r=n(t);o.init=function(t){this.setOptions(t),this.settings.autoPlay&&this.play()},o.setOptions=function(t){this.settings=n.extend(!0,{},a,t);var e=this.settings,o=e.start,i=e.end;r.css({marginTop:"0px",marginLeft:"0px",position:"fixed"}).appendTo("body"),null!=i.width&&null!=i.height&&n.extend(!0,o,{width:r.width(),height:r.height()});var l=Math.min(o.top,i.top)-Math.abs(o.left-i.left)/3;l<e.vertex_Rtop&&(l=Math.min(e.vertex_Rtop,Math.min(o.top,i.top)));var s=Math.sqrt(Math.pow(o.top-i.top,2)+Math.pow(o.left-i.left,2)),c=Math.ceil(Math.min(Math.max(Math.log(s)/.05-75,30),100)/e.speed),u=o.top==l?0:-Math.sqrt((i.top-l)/(o.top-l)),p=(u*o.left-i.left)/(u-1),d=i.left==p?0:(i.top-l)/Math.pow(i.left-p,2);n.extend(!0,e,{count:-1,steps:c,vertex_left:p,vertex_top:l,curvature:d})},o.play=function(){this.move()},o.move=function(){var t=this.settings,e=t.start,a=t.count,o=t.steps,i=t.end,l=e.left+(i.left-e.left)*a/o,s=0==t.curvature?e.top+(i.top-e.top)*a/o:t.curvature*Math.pow(l-t.vertex_left,2)+t.vertex_top;if(null!=i.width&&null!=i.height){var c=o/2,u=i.width-(i.width-e.width)*Math.cos(c>a?0:(a-c)/(o-c)*Math.PI/2),p=i.height-(i.height-e.height)*Math.cos(c>a?0:(a-c)/(o-c)*Math.PI/2);r.css({width:u+"px",height:p+"px","font-size":Math.min(u,p)+"px"})}r.css({left:l+"px",top:s+"px"}),t.count++;var d=window.requestAnimationFrame(n.proxy(this.move,this));a==o&&(window.cancelAnimationFrame(d),t.onEnd.apply(this))},o.destory=function(){r.remove()},o.init(e)},n.fn.fly=function(t){return this.each(function(){void 0==n(this).data("fly")&&n(this).data("fly",new n.fly(this,t))})}}}]);